"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.requestIdToReadStateOptions = exports.requestIdFromReadStateOptions = exports.decodeCallRequest = void 0;
const agent_1 = require("@dfinity/agent");
const principal_1 = require("@dfinity/principal");
const decodeCallRequest = (contentMap) => {
    const decoded = agent_1.Cbor.decode(contentMap);
    const expiry = new agent_1.Expiry(0);
    // @ts-ignore Expiry class currently has no method to create instance from value
    expiry._value = BigInt(decoded.ingress_expiry.toString(10));
    return Object.assign(Object.assign({}, decoded), { canister_id: principal_1.Principal.from(decoded.canister_id), ingress_expiry: expiry });
};
exports.decodeCallRequest = decodeCallRequest;
const requestIdFromReadStateOptions = (options) => {
    if (options.paths.length === 1 && options.paths[0].length == 2) {
        const path = new TextDecoder().decode(options.paths[0][0]);
        if (path === "request_status") {
            return options.paths[0][1];
        }
    }
    throw Error("Request id could not be found in options");
};
exports.requestIdFromReadStateOptions = requestIdFromReadStateOptions;
const requestIdToReadStateOptions = (requestId) => ({
    paths: [[new TextEncoder().encode("request_status"), requestId]],
});
exports.requestIdToReadStateOptions = requestIdToReadStateOptions;
//# sourceMappingURL=utils.js.map